/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/** Burrows-Wheeler transform, computed with the Induced Sorting Suffix Array
 *  construction mechanism (sais).  Code is a port of:
 *    https://sites.google.com/site/yuta256/sais
 *  which is:
 *    Copyright (c) 2008-2010 Yuta Mori All Rights Reserved.
 *  and licensed under an MIT/X11 license.  I generally looked at both
 *  the C and the Java implementations to guide my work.
 *
 * This JavaScript port is:
 *    Copyright (c) 2013 C. Scott Ananian
 * and licensed under GPLv2; see the README at the top level of this package.
 */

/* Range Coder.  Inspired by rangecod.c from rngcod13.zip from
 *    http://www.compressconsult.com/rangecoder/
 * This JavaScript version is:
 *    Copyright (c) 2013 C. Scott Ananian.
 */

/* CRC32, used in Bzip2 implementation.
 * This is a port of CRC32.java from the jbzip2 implementation at
 *   https://code.google.com/p/jbzip2
 * which is:
 *   Copyright (c) 2011 Matthew Francis
 *
 *   Permission is hereby granted, free of charge, to any person
 *   obtaining a copy of this software and associated documentation
 *   files (the "Software"), to deal in the Software without
 *   restriction, including without limitation the rights to use,
 *   copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the
 *   Software is furnished to do so, subject to the following
 *   conditions:
 *
 *   The above copyright notice and this permission notice shall be
 *   included in all copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 *   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 *   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 *   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 *   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 *   OTHER DEALINGS IN THE SOFTWARE.
 * This JavaScript implementation is:
 *   Copyright (c) 2013 C. Scott Ananian
 * with the same licensing terms as Matthew Francis' original implementation.
 */

/**
 * An in-place, length restricted Canonical Huffman code length allocator
 *
 * Based on the algorithm proposed by R. L. Milidiú, A. A. Pessoa and
 * E. S. Laber in "In-place Length-Restricted Prefix Coding" (see:
 * http://www-di.inf.puc-rio.br/~laber/public/spire98.ps) and
 * incorporating additional ideas from the implementation of "shcodec"
 * by Simakov Alexander (see: http://webcenter.ru/~xander/)
 *
 * This JavaScript implementation ported from HuffmanAllocator.java from
 *   https://code.google.com/p/jbzip2
 * which is:
 *
 *   Copyright (c) 2011 Matthew Francis
 *
 *   Permission is hereby granted, free of charge, to any person
 *   obtaining a copy of this software and associated documentation
 *   files (the "Software"), to deal in the Software without
 *   restriction, including without limitation the rights to use,
 *   copy, modify, merge, publish, distribute, sublicense, and/or sell
 *   copies of the Software, and to permit persons to whom the
 *   Software is furnished to do so, subject to the following
 *   conditions:
 *
 *   The above copyright notice and this permission notice shall be
 *   included in all copies or substantial portions of the Software.
 *
 *   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 *   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 *   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 *   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 *   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 *   OTHER DEALINGS IN THE SOFTWARE.
 *
 * This JavaScript implementation is:
 *   Copyright (c) 2013 C. Scott Ananian
 * with the same licensing terms as Matthew Francis' original implementation.
 */

/*
An implementation of Bzip2 de/compression, including the ability to
seek within bzip2 data.

Copyright (C) 2013 C. Scott Ananian
Copyright (C) 2012 Eli Skeggs
Copyright (C) 2011 Kevin Kwok

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, see
http://www.gnu.org/licenses/lgpl-2.1.html

Adapted from node-bzip, copyright 2012 Eli Skeggs.
Adapted from bzip2.js, copyright 2011 Kevin Kwok (antimatter15@gmail.com).

Based on micro-bunzip by Rob Landley (rob@landley.net).

Based on bzip2 decompression code by Julian R Seward (jseward@acm.org),
which also acknowledges contributions by Mike Burrows, David Wheeler,
Peter Fenwick, Alistair Moffat, Radford Neal, Ian H. Witten,
Robert Sedgewick, and Jon L. Bentley.

BWT implementation based on work by Yuta Mori; see BWT.js for details.

bzip2 compression code inspired by https://code.google.com/p/jbzip2
*/

/**
$Id: Iuppiter.js 3026 2010-06-23 10:03:13Z Bear $

Copyright (c) 2010 Nuwa Information Co., Ltd, and individual contributors.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice,
     this list of conditions and the following disclaimer.

  2. Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in the
     documentation and/or other materials provided with the distribution.

  3. Neither the name of Nuwa Information nor the names of its contributors
     may be used to endorse or promote products derived from this software
     without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

$Author: Bear $
$Date: 2010-06-23 18:03:13 +0800 (星期三, 23 六月 2010) $
$Revision: 3026 $
*/

/**
 * Compress string or byte array using fast and efficient algorithm.
 *
 * Because of weak of javascript's natural, many compression algorithm
 * become useless in javascript implementation. The main problem is
 * performance, even the simple Huffman, LZ77/78 algorithm will take many
 * many time to operate. We use LZJB algorithm to do that, it suprisingly
 * fulfills our requirement to compress string fastly and efficiently.
 *
 * Our implementation is based on
 * http://src.opensolaris.org/source/raw/onnv/onnv-gate/usr/src/uts/common/fs/zfs/lzjb.c
 * and
 * http://src.opensolaris.org/source/raw/onnv/onnv-gate/usr/src/uts/common/os/compress.c
 * It is licensed under CDDL.
 *
 * @param {Array|Uint8Array|Buffer|stream} input The stream or byte array
 *        that you want to compress.
 * @param {stream} output Optional output stream.
 * @return {Array|Uint8Array|Buffer} Compressed byte array, or 'output'
 */

/**
 * Decompress string or byte array using fast and efficient algorithm.
 *
 * Our implementation is based on
 * http://src.opensolaris.org/source/raw/onnv/onnv-gate/usr/src/uts/common/fs/zfs/lzjb.c
 * and
 * http://src.opensolaris.org/source/raw/onnv/onnv-gate/usr/src/uts/common/os/compress.c
 * It is licensed under CDDL.
 *
 * @param {Array|Uint8Array|Buffer|stream} input The stream or byte array
 *        that you want to decompress.
 * @param {stream} output Optional output stream.
 * @return {Array|Uint8Array|Buffer} Decompressed byte array, or 'output'
 */

(function(e,t){e.compressjs=t()})(this,function(){var e,t,n;return function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("bower_components/almond/almond",function(){}),n("lib/freeze",[],function(){return Object.freeze?Object.freeze:function(e){return e}}),n("lib/Stream",["./freeze"],function(e){var t=-1,n=function(){};return n.prototype.readByte=function(){var e=[0],n=this.read(e,0,1);return n===0?(this._eof=!0,t):e[0]},n.prototype.read=function(e,n,r){var i,s=0;while(s<r){i=this.readByte();if(i===t){this._eof=!0;break}e[n+s++]=i}return s},n.prototype.eof=function(){return!!this._eof},n.prototype.seek=function(e){throw new Error("Stream is not seekable.")},n.prototype.tell=function(){throw new Error("Stream is not seekable.")},n.prototype.writeByte=function(e){var t=[e];this.write(t,0,1)},n.prototype.write=function(e,t,n){var r;for(r=0;r<n;r++)this.writeByte(e[t+r]);return n},n.prototype.flush=function(){},n.EOF=t,e(n)}),n("lib/BitStream",["./Stream"],function(e){var t=function(t){(function(){var n=256;this.readBit=function(){if((n&255)===0){var r=t.readByte();if(r===e.EOF)return this._eof=!0,r;n=r<<1|1}var i=n&256?1:0;return n<<=1,i},this.seekBit=function(e){var t=e>>>3,n=e-t*8;this.seek(t),this._eof=!1,this.readBits(n)},this.tellBit=function(){var e=t.tell()*8,r=n;while((r&255)!==0)e--,r<<=1;return e},this.readByte=function(){return(n&255)===0?t.readByte():this.readBits(8)},this.seek=function(e){t.seek(e),n=256}}).call(this),function(){var e=1;this.writeBit=function(n){e<<=1,n&&(e|=1),e&256&&(t.writeByte(e&255),e=1)},this.writeByte=function(n){e===1?t.writeByte(n):t.writeBits(8,n)},this.flush=function(){while(e!==1)this.writeBit(0);t.flush&&t.flush()}}.call(this)};return t.EOF=e.EOF,t.prototype=Object.create(e.prototype),t.prototype.readBits=function(e){var t,n=0,r;if(e>31)return n=this.readBits(e-16)*65536,n+this.readBits(16);for(t=0;t<e;t++)n<<=1,this.readBit()>0&&n++;return n},t.prototype.writeBits=function(e,t){if(e>32){var n=t&65535,r=(t-n)/65536;this.writeBits(e-16,r),this.writeBits(16,n);return}var i;for(i=e-1;i>=0;i--)this.writeBit(t>>>i&1)},t}),n("lib/Util",["./freeze","./Stream"],function(e,t){var n=Object.create(null),r=t.EOF;n.coerceInputStream=function(e,n){if("readByte"in e){if(n&&!("read"in e)){var s=e;e=new t,e.readByte=function(){var e=s.readByte();return e===r&&(this._eof=!0),e},"size"in s&&(e.size=s.size),"seek"in s&&(e.seek=function(e){s.seek(e),this._eof=!1}),"tell"in s&&(e.tell=s.tell.bind(s))}}else{var i=e;e=new t,e.size=i.length,e.pos=0,e.readByte=function(){return this.pos>=this.size?r:i[this.pos++]},e.read=function(e,t,n){var r=0;while(r<n&&this.pos<i.length)e[t++]=i[this.pos++],r++;return r},e.seek=function(e){this.pos=e},e.tell=function(){return this.pos},e.eof=function(){return this.pos>=i.length}}return e};var i=function(e,t){this.buffer=e,this.resizeOk=t,this.pos=0};i.prototype=Object.create(t.prototype),i.prototype.writeByte=function(e){if(this.resizeOk&&this.pos>=this.buffer.length){var t=n.makeU8Buffer(this.buffer.length*2);t.set(this.buffer),this.buffer=t}this.buffer[this.pos++]=e},i.prototype.getBuffer=function(){if(this.pos!==this.buffer.length){if(!this.resizeOk)throw new TypeError("outputsize does not match decoded input");var e=n.makeU8Buffer(this.pos);e.set(this.buffer.subarray(0,this.pos)),this.buffer=e}return this.buffer},n.coerceOutputStream=function(e,t){var r={stream:e,retval:e};if(e){if(typeof e=="object"&&"writeByte"in e)return r;typeof t=="number"?(console.assert(t>=0),r.stream=new i(n.makeU8Buffer(t),!1)):r.stream=new i(e,!1)}else r.stream=new i(n.makeU8Buffer(16384),!0);return Object.defineProperty(r,"retval",{get:r.stream.getBuffer.bind(r.stream)}),r},n.compressFileHelper=function(e,t,r){return function(i,s,o){i=n.coerceInputStream(i);var u=n.coerceOutputStream(s,s);s=u.stream;var a;for(a=0;a<e.length;a++)s.writeByte(e.charCodeAt(a));var f;"size"in i&&i.size>=0?f=i.size:f=-1;if(r){var l=n.coerceOutputStream([]);n.writeUnsignedNumber(l.stream,f+1),l=l.retval;for(a=0;a<l.length-1;a++)s.writeByte(l[a]);r=l[l.length-1]}else n.writeUnsignedNumber(s,f+1);return t(i,s,f,o,r),u.retval}},n.decompressFileHelper=function(e,t){return function(r,i){r=n.coerceInputStream(r);var s;for(s=0;s<e.length;s++)if(e.charCodeAt(s)!==r.readByte())throw new Error("Bad magic");var o=n.readUnsignedNumber(r)-1,u=n.coerceOutputStream(i,o);return i=u.stream,t(r,i,o),u.retval}},n.compressWithModel=function(e,t,n){var i=0;while(i!==t){var s=e.readByte();if(s===r){n.encode(256);break}n.encode(s),i++}},n.decompressWithModel=function(e,t,n){var r=0;while(r!==t){var i=n.decode();if(i===256)break;e.writeByte(i),r++}},n.writeUnsignedNumber=function(e,t){console.assert(t>=0);var n=[],r;do n.push(t&127),t=Math.floor(t/128);while(t!==0);n[0]|=128;for(r=n.length-1;r>=0;r--)e.writeByte(n[r]);return e},n.readUnsignedNumber=function(e){var t=0,n;for(;;){n=e.readByte();if(n&128){t+=n&127;break}t=(t+n)*128}return t};var s=function(e){for(var t=0,n=e.length;t<n;t++)e[t]=0;return e},o=function(e){return s(new Array(e))},u=function(t){return t};typeof process!="undefined"&&Array.prototype.some.call(new Uint32Array(128),function(e){return e!==0})&&(u=s),n.makeU8Buffer=typeof Uint8Array!="undefined"?function(e){return u(new Uint8Array(e))}:typeof Buffer!="undefined"?function(e){var t=new Buffer(e);return t.fill(0),t}:o,n.makeU16Buffer=typeof Uint16Array!="undefined"?function(e){return u(new Uint16Array(e))}:o,n.makeU32Buffer=typeof Uint32Array!="undefined"?function(e){return u(new Uint32Array(e))}:o,n.makeS32Buffer=typeof Int32Array!="undefined"?function(e){return u(new Int32Array(e))}:o,n.arraycopy=function(e,t){console.assert(e.length>=t.length);for(var n=0,r=t.length;n<r;n++)e[n]=t[n];return e};var a=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];console.assert(a.length===256);var f=n.fls=function(e){return console.assert(e>=0),e>4294967295?32+f(Math.floor(e/4294967296)):(e&4294901760)!==0?(e&4278190080)!==0?24+a[e>>>24&255]:16+a[e>>>16]:(e&65280)!==0?8+a[e>>>8]:a[e]};return n.log2c=function(e){return e===0?-1:f(e-1)},e(n)}),n("lib/BWT",["./freeze","./Util"],function(e,t){var n=console.assert.bind(console),r=function(e,t,n,r){var i;for(i=0;i<r;i++)t[i]=0;for(i=0;i<n;i++)t[e[i]]++},i=function(e,t,n,r){var i,s=0;if(r)for(i=0;i<n;i++)s+=e[i],t[i]=s;else for(i=0;i<n;i++)s+=e[i],t[i]=s-e[i]},s=function(e,t,s,o,u,a){var f,l,c,h,p;s===o&&r(e,s,u,a),i(s,o,a,!1),c=u-1,f=o[p=e[c]],c--,t[f++]=e[c]<p?~c:c;for(l=0;l<u;l++)(c=t[l])>0?(n(e[c]>=e[c+1]),(h=e[c])!==p&&(o[p]=f,f=o[p=h]),n(l<f),c--,t[f++]=e[c]<p?~c:c,t[l]=0):c<0&&(t[l]=~c);s===o&&r(e,s,u,a),i(s,o,a,1);for(l=u-1,f=o[p=0];l>=0;l--)(c=t[l])>0&&(n(e[c]<=e[c+1]),(h=e[c])!==p&&(o[p]=f,f=o[p=h]),n(f<=l),c--,t[--f]=e[c]>p?~(c+1):c,t[l]=0)},o=function(e,t,r,i){var s,o,u,a,f,l,c,h,p,d;n(r>0);for(s=0;(u=t[s])<0;s++)t[s]=~u,n(s+1<r);if(s<i)for(o=s,s++;;s++){n(s<r);if((u=t[s])<0){t[o++]=~u,t[s]=0;if(o===i)break}}h=e[s=o=r-1];do p=h;while(--s>=0&&(h=e[s])>=p);for(;s>=0;){do p=h;while(--s>=0&&(h=e[s])<=p);if(s>=0){t[i+(s+1>>>1)]=o-s,o=s+1;do p=h;while(--s>=0&&(h=e[s])>=p)}}for(s=0,c=0,a=r,l=0;s<i;s++){u=t[s],f=t[i+(u>>>1)],d=!0;if(f===l&&a+f<r){for(o=0;o<f&&e[u+o]===e[a+o];)o++;o===f&&(d=!1)}d&&(c++,a=u,l=f),t[i+(u>>>1)]=c}return c},u=function(e,t,s,o,u,a){var f,l,c,h,p;s===o&&r(e,s,u,a),i(s,o,a,!1),c=u-1,f=o[p=e[c]],t[f++]=c>0&&e[c-1]<p?~c:c;for(l=0;l<u;l++)c=t[l],t[l]=~c,c>0&&(c--,n(e[c]>=e[c+1]),(h=e[c])!==p&&(o[p]=f,f=o[p=h]),n(l<f),t[f++]=c>0&&e[c-1]<p?~c:c);s===o&&r(e,s,u,a),i(s,o,a,!0);for(l=u-1,f=o[p=0];l>=0;l--)(c=t[l])>0?(c--,n(e[c]<=e[c+1]),(h=e[c])!==p&&(o[p]=f,f=o[p=h]),n(f<=l),t[--f]=c===0||e[c-1]>p?~c:c):t[l]=~c},a=function(e,t,s,o,u,a){var f,l,c,h=-1,p,d;s===o&&r(e,s,u,a),i(s,o,a,!1),c=u-1,f=o[d=e[c]],t[f++]=c>0&&e[c-1]<d?~c:c;for(l=0;l<u;l++)(c=t[l])>0?(c--,n(e[c]>=e[c+1]),t[l]=~(p=e[c]),p!==d&&(o[d]=f,f=o[d=p]),n(l<f),t[f++]=c>0&&e[c-1]<d?~c:c):c!==0&&(t[l]=~c);s===o&&r(e,s,u,a),i(s,o,a,!0);for(l=u-1,f=o[d=0];l>=0;l--)(c=t[l])>0?(c--,n(e[c]<=e[c+1]),t[l]=p=e[c],p!==d&&(o[d]=f,f=o[d=p]),n(f<=l),t[--f]=c>0&&e[c-1]>d?~e[c-1]:c):c!==0?t[l]=~c:h=l;return h},f=function(e,l,c,h,p,d){var v,m,g,y,b,w,E,S,x,T,N,C=0,k,L,A,O=0;p<=256?(v=t.makeS32Buffer(p),p<=c?(m=l.subarray(h+c-p),O=1):(m=t.makeS32Buffer(p),O=3)):p<=c?(v=l.subarray(h+c-p),p<=c-p?(m=l.subarray(h+c-p*2),O=0):p<=1024?(m=t.makeS32Buffer(p),O=2):(m=v,O=8)):(v=m=t.makeS32Buffer(p),O=12),r(e,v,h,p),i(v,m,p,!0);for(y=0;y<h;y++)l[y]=0;w=-1,y=h-1,b=h,S=0,L=e[h-1];do A=L;while(--y>=0&&(L=e[y])>=A);for(;y>=0;){do A=L;while(--y>=0&&(L=e[y])<=A);if(y>=0){w>=0&&(l[w]=b),w=--m[A],b=y,++S;do A=L;while(--y>=0&&(L=e[y])>=A)}}S>1?(s(e,l,v,m,h,p),N=o(e,l,h,S)):S===1?(l[w]=b+1,N=1):N=0;if(N<S){(O&4)!==0&&(v=null,m=null),(O&2)!==0&&(m=null),k=h+c-S*2,(O&13)===0&&(p+N<=k?k-=p:O|=8),n(h>>>1<=k+S);for(y=S+(h>>>1)-1,b=S*2+k-1;S<=y;y--)l[y]!==0&&(l[b--]=l[y]-1);g=l.subarray(S+k),f(g,l,k,S,N,!1),g=null,y=h-1,b=S*2-1,L=e[h-1];do A=L;while(--y>=0&&(L=e[y])>=A);for(;y>=0;){do A=L;while(--y>=0&&(L=e[y])<=A);if(y>=0){l[b--]=y+1;do A=L;while(--y>=0&&(L=e[y])>=A)}}for(y=0;y<S;y++)l[y]=l[S+l[y]];(O&4)!==0&&(v=m=t.makeS32Buffer(p)),(O&2)!==0&&(m=t.makeS32Buffer(p))}(O&8)!==0&&r(e,v,h,p);if(S>1){i(v,m,p,!0),y=S-1,b=h,x=l[S-1],A=e[x];do{T=m[L=A];while(T<b)l[--b]=0;do{l[--b]=x;if(--y<0)break;x=l[y]}while((A=e[x])===L)}while(y>=0);while(b>0)l[--b]=0}return d?C=a(e,l,v,m,h,p):u(e,l,v,m,h,p),v=null,m=null,C},l=Object.create(null);return l.suffixsort=function(e,t,r,i){n(e&&t&&e.length>=r&&t.length>=r);if(r<=1)return r===1&&(t[0]=0),0;if(!i)if(e.BYTES_PER_ELEMENT===1)i=256;else{if(e.BYTES_PER_ELEMENT!==2)throw new Error("Need to specify alphabetSize");i=65536}return n(i>0),e.BYTES_PER_ELEMENT&&n(i<=1<<e.BYTES_PER_ELEMENT*8),f(e,t,0,r,i,!1)},l.bwtransform=function(e,t,r,i,s){var o,u;n(e&&t&&r),n(e.length>=i&&t.length>=i&&r.length>=i);if(i<=1)return i===1&&(t[0]=e[0]),i;if(!s)if(e.BYTES_PER_ELEMENT===1)s=256;else{if(e.BYTES_PER_ELEMENT!==2)throw new Error("Need to specify alphabetSize");s=65536}n(s>0),e.BYTES_PER_ELEMENT&&n(s<=1<<e.BYTES_PER_ELEMENT*8),u=f(e,r,0,i,s,!0),t[0]=e[i-1];for(o=0;o<u;o++)t[o+1]=r[o];for(o+=1;o<i;o++)t[o]=r[o];return u+1},l.unbwtransform=function(e,n,r,i,s){var o=t.makeU32Buffer(256),u,a;for(u=0;u<256;u++)o[u]=0;for(u=0;u<i;u++)r[u]=o[e[u]]++;for(u=0,a=0;u<256;u++)a+=o[u],o[u]=a-o[u];for(u=i-1,a=0;u>=0;u--)a=r[a]+o[n[u]=e[a]],a+=a<s?1:0;o=null},l.bwtransform2=function(e,r,i,s){var o,u,a=0;n(e&&r),n(e.length>=i&&r.length>=i);if(i<=1)return i===1&&(r[0]=e[0]),0;if(!s)if(e.BYTES_PER_ELEMENT===1)s=256;else{if(e.BYTES_PER_ELEMENT!==2)throw new Error("Need to specify alphabetSize");s=65536}n(s>0),e.BYTES_PER_ELEMENT&&n(s<=1<<e.BYTES_PER_ELEMENT*8);var l;e.length>=i*2?l=e:s<=256?l=t.makeU8Buffer(i*2):s<=65536?l=t.makeU16Buffer(i*2):l=t.makeU32Buffer(i*2);if(l!==e)for(o=0;o<i;o++)l[o]=e[o];for(o=0;o<i;o++)l[i+o]=l[o];var c=t.makeS32Buffer(i*2);f(l,c,0,i*2,s,!1);for(o=0,u=0;o<2*i;o++){var h=c[o];h<i&&(h===0&&(a=u),--h<0&&(h=i-1),r[u++]=e[h])}return n(u===i),a},e(l)}),n("lib/Huffman",["./BitStream","./Util"],function(e,t){var n=function(e,t,n,r){this.up=e,this.down=t,this.symbol=n,this.weight=r};n.prototype.clone=function(){return new n(this.up,this.down,this.symbol,this.weight)},n.prototype.set=function(e){this.up=e.up,this.down=e.down,this.symbol=e.symbol,this.weight=e.weight};var r=function(e,t,r,i){var s;console.assert(e&&typeof e=="number");if(!t||t>e)t=e;(t<<=1)&&t--,this.table=[];for(s=0;s<=t;s++)this.table[s]=new n(0,0,0,0);this.map=[];if(this.size=e)for(s=0;s<e;s++)this.map[s]=0;this.esc=this.root=t,r&&(this.readBit=r.readBit.bind(r),this.writeBit=r.writeBit.bind(r)),this.max_weight=i};return r.factory=function(e,t){return function(n){return new r(n,n,e,t)}},r.prototype.split=function(e){var t,n;return(t=this.esc)?(this.esc--,(n=this.esc)?(this.table[t].down=n,this.table[t].weight=1,this.table[n].up=t,this.esc--):(t=0,n=1),this.table[n].symbol=e,this.table[n].weight=0,this.table[n].down=0,this.map[e]=n,this.table[this.esc].weight=0,this.table[this.esc].down=0,this.table[this.esc].up=t,n):(console.assert(!1),0)},r.prototype.leader=function(e){var t=this.table[e].weight,n=e,r,i;while(t===this.table[n+1].weight)n++;return n===e?e:(i=this.table[e].symbol,r=this.table[n].symbol,this.table[n].symbol=i,this.table[e].symbol=r,this.map[i]=n,this.map[r]=e,n)},r.prototype.slide=function(e){var t=e,n;n=this.table[t++].clone();if(n.weight&1)while(n.weight>this.table[t+1].weight)t++;return this.table[e].set(this.table[t]),this.table[t].set(n),this.table[t].up=this.table[e].up,this.table[e].up=n.up,n.weight&1?(this.table[n.down].up=t,this.table[n.down-1].up=t,this.map[this.table[e].symbol]=e):(this.table[this.table[e].down-1].up=e,this.table[this.table[e].down].up=e,this.map[n.symbol]=t),t},r.prototype.increment=function(e){var t;this.table[e].up===e+1?(this.table[e].weight+=2,e++):e=this.leader(e);while(this.table[e].weight+=2,t=this.table[e].up){while(this.table[e].weight>this.table[e+1].weight)e=this.slide(e);this.table[e].weight&1?e=t:e=this.table[e].up}this.max_weight&&this.table[this.root].weight>=this.max_weight&&this.scale(1)},r.prototype.scale=function(e){var t=this.esc,n,r;while(++t<=this.root){if(this.table[t].weight&1){if(n=this.table[this.table[t].down].weight&-2)n+=this.table[this.table[t].down-1].weight|1}else(n=this.table[t].weight>>e&-2)||(this.map[this.table[t].symbol]=0,this.esc++)&&this.esc++;this.table[t].weight=n,r=t;while(n<this.table[--r].weight)this.slide(r)}this.table[this.esc].down=0},r.prototype.sendid=function(e){var t=0,n;while(e--)this.map[e]||t++;if(n=this.size-Math.floor((this.root-this.esc)/2)-1)do this.writeBit(t&1),t>>=1;while(n>>=1)},r.prototype.encode=function(e){var t=1,n,r,i,s;if(!(e<this.size)){console.assert(!1);return}s=this.map[e];if(!(i=s)&&!(i=this.esc))return;while(r=this.table[i].up)t<<=1,t|=i&1,i=r;while(n=t&1,t>>=1)this.writeBit(n);s||(this.sendid(e),s=this.split(e)),this.increment(s)},r.prototype.readid=function(){var e=0,t=1,n,r;if(n=this.size-Math.floor((this.root-this.esc)/2)-1)do e|=this.readBit()?t:0,t<<=1;while(n>>=1);for(r=0;r<this.size;r++)if(!this.map[r]&&!(e--))return r;return console.assert(!1),0},r.prototype.decode=function(){var e=this.root,t,n;while(n=this.table[e].down)this.readBit()?e=n-1:e=n;if(e===this.esc){if(!this.esc)return console.assert(!1),0;t=this.readid(),e=this.split(t)}else t=this.table[e].symbol;return this.increment(e),t},r.MAGIC="huff",r.compressFile=t.compressFileHelper(r.MAGIC,function(n,i,s,o){var u=new e(i),a=256;s<0&&a++;var f=new r(257,a,u,8191);t.compressWithModel(n,s,f),u.flush()}),r.decompressFile=t.decompressFileHelper(r.MAGIC,function(n,i,s){var o=new e(n),u=256;s<0&&u++;var a=new r(257,u,o,8191);t.decompressWithModel(i,s,a)}),r}),n("lib/Context1Model",["./BitStream","./Huffman","./Util"],function(e,t,n){var r=function(e,t,n){var r;this.literalModel=[];for(r=0;r<t;r++)this.literalModel[r]=e(n)};return r.prototype.encode=function(e,t){this.literalModel[t].encode(e)},r.prototype.decode=function(e){return this.literalModel[e].decode()},r.MAGIC="ctx1",r.compressFile=n.compressFileHelper(r.MAGIC,function(i,s,o,u){var a=new e(s),f=256;o<0&&f++;var l=t.factory(a,8191),c=new r(l,256,f),h=32,p={encode:function(e){c.encode(e,h),h=e}};n.compressWithModel(i,o,p),a.flush()}),r.decompressFile=n.decompressFileHelper(r.MAGIC,function(i,s,o){var u=new e(i),a=256;o<0&&a++;var f=t.factory(u,8191),l=new r(f,256,a),c=32,h={decode:function(){var e=l.decode(c);return c=e,e}};n.decompressWithModel(s,o,h)}),r}),n("lib/RangeCoder",[],function(){var e=32,t=Math.pow(2,e-1),n=e-9,r=(e-2)%8+1,i=t>>>8,s=Math.pow(2,e)-1,o=function(e){this.low=0,this.range=t,this.buffer=0,this.help=0,this.bytecount=0,this.stream=e},u=function(e,r){while(e.range<=i){if(e.low<255<<n){r.writeByte(e.buffer);for(;e.help;e.help--)r.writeByte(255);e.buffer=e.low>>>n&255}else if(e.low&t){r.writeByte(e.buffer+1);for(;e.help;e.help--)r.writeByte(0);e.buffer=e.low>>>n&255}else{e.help++;if(e.help>s)throw new Error("Too many bytes outstanding, file too large!")}e.range=e.range<<8>>>0,e.low=(e.low<<8&t-1)>>>0,e.bytecount++}};o.prototype.encodeStart=function(e,n){this.low=0,this.range=t,this.buffer=e,this.help=0,this.bytecount=n},o.prototype.encodeFreq=function(e,t,n){u(this,this.stream);var r=this.range/n>>>0,i=r*t;this.low+=i,t+e<n?this.range=r*e:this.range-=i},o.prototype.encodeShift=function(e,t,n){u(this,this.stream);var r=this.range>>>n,i=r*t;this.low+=i,t+e>>>n?this.range-=i:this.range=r*e},o.prototype.encodeBit=function(e){this.encodeShift(1,e?1:0,1)},o.prototype.encodeByte=function(e){this.encodeShift(1,e,8)},o.prototype.encodeShort=function(e){this.encodeShift(1,e,16)},o.prototype.encodeFinish=function(){var e=this.stream;u(this,e),this.bytecount+=5;var t=this.low>>>n;(this.low&i-1)>=(this.bytecount&16777215)>>>1&&t++;if(t>255){e.writeByte(this.buffer+1);for(;this.help;this.help--)e.writeByte(0)}else{e.writeByte(this.buffer);for(;this.help;this.help--)e.writeByte(255)}return e.writeByte(t&255),e.writeByte(this.bytecount>>>16&255),e.writeByte(this.bytecount>>>8&255),e.writeByte(this.bytecount&255),this.bytecount},o.prototype.decodeStart=function(e){var t=e?0:this.stream.readByte();return typeof t!="number"||t<0?t:(this.buffer=this.stream.readByte(),this.low=this.buffer>>>8-r,this.range=1<<r,t)};var a=function(e,t){while(e.range<=i)e.low=e.low<<8|e.buffer<<r&255,e.buffer=t.readByte(),e.low|=e.buffer>>>8-r,e.low=e.low>>>0,e.range=e.range<<8>>>0};return o.prototype.decodeCulFreq=function(e){a(this,this.stream),this.help=this.range/e>>>0;var t=this.low/this.help>>>0;return t>=e?e-1:t},o.prototype.decodeCulShift=function(e){a(this,this.stream),this.help=this.range>>>e;var t=this.low/this.help>>>0;return t>>>e?(1<<e)-1:t},o.prototype.decodeUpdate=function(e,t,n){var r=this.help*t;this.low-=r,t+e<n?this.range=this.help*e:this.range-=r},o.prototype.decodeBit=function(){var e=this.decodeCulShift(1);return this.decodeUpdate(1,e,2),e},o.prototype.decodeByte=function(){var e=this.decodeCulShift(8);return this.decodeUpdate(1,e,256),e},o.prototype.decodeShort=function(){var e=this.decodeCulShift(16);return this.decodeUpdate(1,e,65536),e},o.prototype.decodeFinish=function(){a(this,this.stream)},o.prototype.writeBit=o.prototype.encodeBit,o.prototype.readBit=o.prototype.decodeBit,o.prototype.writeByte=o.prototype.encodeByte,o.prototype.readByte=o.prototype.decodeByte,o}),n("lib/DefSumModel",["./RangeCoder","./Stream","./Util"],function(e,t,n){var r=8,i=1<<r,s=40,o=function(e,t,r){var s;console.assert(t<300);var o=this.numSyms=t;this.coder=e,this.prob=n.makeU16Buffer(t+2),this.escape=n.makeU16Buffer(t+1),this.update=n.makeU16Buffer(t+1),this.prob[o+1]=i;for(s=0;s<=this.numSyms;s++)this.escape[s]=s;this.updateCount=0,this.updateThresh=i-Math.floor(i/2);if(!r)return;this.probToSym=n.makeU16Buffer(i),this.escProbToSym=n.makeU16Buffer(this.numSyms);for(s=0;s<i;s++)this.probToSym[s]=o;for(s=0;s<this.numSyms;s++)this.escProbToSym[s]=s};return o.factory=function(e,t){return function(n){return new o(e,n,t)}},o.prototype._update=function(e,t){if(e===this.numSyms){if(this.update[e]>=s)return;if(this.updateCount>=this.updateThresh-1)return}this.update[e]++,this.updateCount++;if(this.updateCount<this.updateThresh)return;var n,r,o,u,a,f;this.escape[0]=this.prob[0]=n=r=o=0;for(u=0;u<this.numSyms+1;u++){var l=(this.prob[u+1]-this.prob[u]>>>1)+this.update[u];l?(this.prob[u]=n,n+=l,l&1&&o++,this.escape[u]=r):(this.prob[u]=n,this.escape[u]=r,r++)}this.prob[u]=n,console.assert(n===i),this.updateThresh=i-Math.floor((n-o)/2);for(u=0;u<this.numSyms+1;u++)this.update[u]=0;this.update[this.numSyms]=1,this.updateCount=1;if(!t)return;for(u=0,a=0,f=0;u<this.numSyms+1;u++){var c=this.prob[u+1];for(;a<c;a++)this.probToSym[a]=u;var h=this.escape[u+1];for(;f<h;f++)this.escProbToSym[f]=u}},o.prototype.encode=function(e){var t=this.prob[e],n=this.prob[e+1]-t;console.assert(this.prob[this.numSyms+1]===i);if(n)return this.coder.encodeShift(n,t,r),this._update(e);console.assert(e!==this.numSyms),this.encode(this.numSyms),t=this.escape[e],n=this.escape[e+1]-t;var s=this.escape[this.numSyms];return this.coder.encodeFreq(n,t,s),this._update(e)},o.prototype.decode=function(){var e=this.coder.decodeCulShift(r),t=this.probToSym[e],n=this.prob[t],s=this.prob[t+1]-n;this.coder.decodeUpdate(s,n,i),this._update(t,!0);if(t!==this.numSyms)return t;var o=this.escape[this.numSyms];return e=this.coder.decodeCulFreq(o),t=this.escProbToSym[e],n=this.escape[t],s=this.escape[t+1]-n,this.coder.decodeUpdate(s,n,o),this._update(t,!0),t},o.MAGIC="dfsm",o.compressFile=n.compressFileHelper(o.MAGIC,function(t,r,i,s,u){var a=new e(r);a.encodeStart(u,1);var f=new o(a,i<0?257:256);n.compressWithModel(t,i,f),a.encodeFinish()},!0),o.decompressFile=n.decompressFileHelper(o.MAGIC,function(t,r,i){var s=new e(t);s.decodeStart(!0);var u=new o(s,i<0?257:256,!0);n.decompressWithModel(r,i,u),s.decodeFinish()}),o}),n("lib/FenwickModel",["./RangeCoder","./Stream","./Util"],function(e,t,n){var r=65280,i=256,s=65535,o=0,u=4294901760,a=16,f=4294901758,l=function(e,t,s,u){this.coder=e,this.numSyms=t+1,this.tree=n.makeU32Buffer(this.numSyms*2),this.increment=+u||i,this.max_prob=+s||r,console.assert(this.max_prob+(this.increment-1)<=65535),console.assert(t<=65535);var f;for(f=0;f<t;f++)this.tree[this.numSyms+f]=1<<o|0<<a;this.tree[this.numSyms+f]=0<<o|this.increment<<a,this._sumTree()};return l.factory=function(e,t,n){return function(r){return new l(e,r,t,n)}},l.prototype.clone=function(){var e=new l(this.coder,this.size,this.max_prob,this.increment),t;for(t=1;t<this.tree.length;t++)e.tree[t]=this.tree[t];return e},l.prototype.encode=function(e){var t=this.numSyms+e,n=this.tree[t],r=u,i=a,f=this.increment<<a;(n&u)===0?(this.encode(this.numSyms-1),r=s,f-=1<<o,i=o):e===this.numSyms-1&&(this.tree[1]&s)>>>o===1&&(f=-this.tree[t]);var l=0;while(t>1){var c=t&1,h=t>>>1;c&&(l+=this.tree[2*h]),this.tree[t]+=f,t=h}var p=this.tree[1];this.tree[1]+=f,n=(n&r)>>>i,l=(l&r)>>>i,p=(p&r)>>>i,this.coder.encodeFreq(n,l,p),(this.tree[1]&u)>>>a>=this.max_prob&&this._rescale()},l.prototype._decode=function(e){var t=u,n=a,r=this.increment<<a;e&&(t=s,r-=1<<o,n=o);var i=(this.tree[1]&t)>>>n,f=this.coder.decodeCulFreq(i),l=1,c=0;while(l<this.numSyms){this.tree[l]+=r;var h=(this.tree[2*l]&t)>>>n;l*=2,f-c>=h&&(c+=h,l++)}var p=l-this.numSyms,d=(this.tree[l]&t)>>>n;this.tree[l]+=r,this.coder.decodeUpdate(d,c,i);if(p===this.numSyms-1&&(this.tree[1]&s)>>>o===1){r=-this.tree[l];while(l>=1)this.tree[l]+=r,l>>>=1}return(this.tree[1]&u)>>>a>=this.max_prob&&this._rescale(),p},l.prototype.decode=function(){var e=this._decode(!1);return e===this.numSyms-1&&(e=this._decode(!0)),e},l.prototype._rescale=function(){var e,t,n=!0;for(e=0;e<this.numSyms-1;e++){t=this.tree[this.numSyms+e];if((t&s)!==0){n=!1;continue}t=(t&f)>>>1,t===0&&(t=1<<o,n=!1),this.tree[this.numSyms+e]=t}t=this.tree[this.numSyms+e],t=(t&f)>>>1,n?t=0:t===0&&(t=1<<a),this.tree[this.numSyms+e]=t,this._sumTree()},l.prototype._sumTree=function(){var e;for(e=this.numSyms-1;e>0;e--)this.tree[e]=this.tree[2*e]+this.tree[2*e+1]},l.MAGIC="fenw",l.compressFile=n.compressFileHelper(l.MAGIC,function(t,r,i,s,o){var u=new e(r);u.encodeStart(o,1);var a=new l(u,i<0?257:256);n.compressWithModel(t,i,a),u.encodeFinish()},!0),l.decompressFile=n.decompressFileHelper(l.MAGIC,function(t,r,i){var s=new e(t);s.decodeStart(!0);var o=new l(s,i<0?257:256);n.decompressWithModel(r,i,o),s.decodeFinish()}),l}),n("lib/MTFModel",["./RangeCoder","./Stream","./Util"],function(e,t,n){var r=65280,i=256,s=function(e,t){return e-t},o=function(e,t,s,o,u){this.coder=e,this.increment=+o||i,this.max_prob=+s||r,console.assert(this.max_prob+(this.increment-1)<=65535),this.sym=n.makeU16Buffer(t+1),this.prob=n.makeU16Buffer(t+2),this.sym[0]=t,this.prob[0]=0,this.seenSyms=1,this.prob[this.seenSyms]=this.increment,this.numSyms=t,u&&(this.sortedSeen=[t])};return o.factory=function(e,t,n,r){return function(i){return new o(e,i,t,n,r)}},o.prototype.clone=function(){var e=new o(this.coder,this.numSyms,this.max_prob,this.increment,!!this.sortedSeen),t;for(t=0;t<this.seenSyms;t++)e.sym[t]=this.sym[t],e.prob[t]=this.prob[t];return e.prob[t]=this.prob[t],e.seenSyms=this.seenSyms,this.sortedSeen&&(e.sortedSeen=this.sortedSeen.slice(0)),e},o.prototype._update=function(e,t,n){var r,i;for(r=t;r<this.seenSyms-1;r++)this.sym[r]=this.sym[r+1],this.prob[r]=this.prob[r+1]-n;t<this.seenSyms?(this.sym[r]=e,this.prob[r]=this.prob[r+1]-n,this.prob[this.seenSyms]=i=this.prob[this.seenSyms]+this.increment,e===this.numSyms&&this.seenSyms>=this.numSyms&&(i=this.prob[--this.seenSyms],this.sortedSeen&&this.sortedSeen.length--)):(i=this.prob[this.seenSyms],this.sym[t]=e,this.prob[t]=i,i+=this.increment,this.prob[++this.seenSyms]=i,this.sortedSeen&&(this.sortedSeen.push(e),this.sortedSeen.sort(s))),i>=this.max_prob&&this._rescale();return},o.prototype._rescale=function(){var e,t,n=0,r=!0;this.sortedSeen&&(this.sortedSeen.length=0);for(e=0,t=0;e<this.seenSyms;e++){var i=this.sym[e],o=this.prob[e+1]-this.prob[e];o>>>=1,o>0&&(i===this.numSyms&&(r=!1),this.sym[t]=i,this.prob[t++]=n,n+=o,this.sortedSeen&&this.sortedSeen.push(i))}this.prob[t]=n,this.seenSyms=t,this.sortedSeen&&this.sortedSeen.sort(s),r&&this.seenSyms<this.numSyms&&this._update(this.numSyms,this.seenSyms)},o.prototype.decode=function(){var e=this.prob[this.seenSyms],t=this.coder.decodeCulFreq(e),n;for(n=this.seenSyms-1;n>=0;n--)if(this.prob[n]<=t)break;console.assert(n>=0);var r=this.sym[n],i=this.prob[n],s=this.prob[n+1]-i;this.coder.decodeUpdate(s,i,e),this._update(r,n,s);if(r===this.numSyms){s=1,e=this.numSyms;if(this.sortedSeen){var o=this.sortedSeen;e=this.numSyms-this.seenSyms,o[o.length-1]===this.numSyms&&e++,r=i=this.coder.decodeCulFreq(e);for(n=0;n<o.length&&o[n]<=r;n++)r++}else r=i=this.coder.decodeCulFreq(e);this.coder.decodeUpdate(s,i,e),this._update(r,this.seenSyms)}return r},o.prototype.encode=function(e){var t,n,r,i;for(t=this.seenSyms-1;t>=0;t--)if(e===this.sym[t])return r=this.prob[t],n=this.prob[t+1]-r,i=this.prob[this.seenSyms],this.coder.encodeFreq(n,r,i),this._update(e,t,n);console.assert(e!==this.numSyms),this.encode(this.numSyms),n=1,r=e,i=this.numSyms;if(this.sortedSeen){var s=this.sortedSeen;i-=this.seenSyms,s[s.length-1]===this.numSyms&&i++;for(t=0;t<s.length&&s[t]<e;t++)r--}return this.coder.encodeFreq(n,r,i),this._update(e,this.seenSyms)},o.MAGIC="mtfm",o.compressFile=n.compressFileHelper(o.MAGIC,function(t,r,i,s,u){var a=new e(r);a.encodeStart(u,1);var f=new o(a,i<0?257:256);n.compressWithModel(t,i,f),a.encodeFinish()},!0),o.decompressFile=n.decompressFileHelper(o.MAGIC,function(t,r,i){var s=new e(t);s.decodeStart(!0);var u=new o(s,i<0?257:256);n.decompressWithModel(r,i,u),s.decodeFinish()}),o}),n("lib/NoModel",["./BitStream","./Util"],function(e,t){var n=function(e,n){this.bitstream=e,this.bits=t.fls(n-1)};return n.factory=function(e){return function(t){return new n(e,t)}},n.prototype.encode=function(e){var t;for(t=this.bits-1;t>=0;t--){var n=e>>>t&1;this.bitstream.writeBit(n)}},n.prototype.decode=function(){var e,t=0;for(e=this.bits-1;e>=0;e--)t<<=1,this.bitstream.readBit()&&t++;return t},n.MAGIC="nomo",n.compressFile=t.compressFileHelper(n.MAGIC,function(r,i,s,o){var u=new e(i),a=new n(u,s<0?257:256);t.compressWithModel(r,s,a),u.flush()}),n.decompressFile=t.decompressFileHelper(n.MAGIC,function(r,i,s){var o=new e(r),u=new n(o,s<0?257:256);t.decompressWithModel(i,s,u)}),n}),n("lib/LogDistanceModel",["./Util"],function(e){var t=function(t,n,r,i){var s,o=e.fls(t-1);this.extraStates=+n||0,this.lgDistanceModel=r(1+o+n),this.distanceModel=[];for(s=2;s<=o;s++){var u=s-1;this.distanceModel[s]=i(1<<u)}};return t.prototype.encode=function(t){if(t<2){this.lgDistanceModel.encode(t+this.extraStates);return}var n=e.fls(t);console.assert(t&1<<n-1),console.assert(n>=2),this.lgDistanceModel.encode(n+this.extraStates);var r=t&(1<<n-1)-1;this.distanceModel[n].encode(r)},t.prototype.decode=function(){var e=this.lgDistanceModel.decode()-this.extraStates;if(e<2)return e;var t=this.distanceModel[e].decode();return(1<<e-1)+t},t}),n("lib/BWTC",["./freeze","./BWT","./DefSumModel","./FenwickModel","./LogDistanceModel","./NoModel","./RangeCoder","./Stream","./Util"],function(e,t,n,r,i,s,o,u,a){var f=u.EOF,l=65280,c=256;return BWTC=Object.create(null),BWTC.MAGIC="bwtc",BWTC.compressFile=a.compressFileHelper(BWTC.MAGIC,function(e,u,f,h,p){var d=new o(u);d.encodeStart(p,1);var v=9;typeof h=="number"&&h>=1&&h<=9&&(v=h),d.encodeByte(v);var m=v<=5;v*=1e5;var g=a.makeU8Buffer(v),y=function(){var t;for(t=0;t<v;){var n=e.readByte();if(n<0)break;g[t++]=n}return t},b=a.makeU8Buffer(v),w=a.makeS32Buffer(v),E=a.makeU8Buffer(256),S=s.factory(d),x=new i(v,0,S,S),T,N,C,k,L,A;do{T=y();if(T===0)break;T===g.length?(d.encodeFreq(1,0,3),N=g):(d.encodeFreq(1,1,3),x.encode(T),N=g.subarray(0,T)),k=t.bwtransform(N,b,w,T,256),x.encode(k);var O=a.makeU16Buffer(512);for(L=0;L<T;L++)C=b[L],O[256+C]=1;for(L=255;L>0;L--)O[L]=O[2*L]+O[2*L+1];O[0]=1;for(L=1;L<512;L++){var M=L>>>1,_=1<<9-a.fls(L);if(O[M]!==0&&O[M]!==_*2)if(L>=256)d.encodeBit(O[L]);else{var D=O[L];D=D===0?0:D===_?2:1,d.encodeFreq(1,D,3)}}var P=0;for(L=0;L<256;L++)O[256+L]&&(E[P++]=L);O=null;for(L=0;L<T;L++){C=b[L];for(A=0;A<P;A++)if(E[A]===C)break;console.assert(A<P),b[L]=A;for(;A>0;A--)E[A]=E[A-1];E[0]=C}var H=new r(d,P+1,l,c);m&&(H=new n(d,P+1));var B=0,j=function(){while(B!==0)B&1?(H.encode(0),B-=1):(H.encode(1),B-=2),B>>>=1};for(L=0;L<T;L++)C=b[L],C===0?B++:(j(),H.encode(C+1),B=0);j()}while(T===g.length);d.encodeFreq(1,2,3),d.encodeFinish()},!0),BWTC.decompressFile=a.decompressFileHelper(BWTC.MAGIC,function(e,u,f){var h=new o(e);h.decodeStart(!0);var p=h.decodeByte();console.assert(p>=1&&p<=9);var d=p<=5;p*=1e5;var v=a.makeU8Buffer(p),m=a.makeU8Buffer(p),g=a.makeS32Buffer(p),y=a.makeU8Buffer(256),b=s.factory(h),w=new i(p,0,b,b),E,S,x,T,N;for(;;){var C=h.decodeCulFreq(3);h.decodeUpdate(1,C,3);if(C===0)S=p,E=v;else if(C===1)S=w.decode(),E=v.subarray(0,S);else if(C===2)break;var k=w.decode(),L=a.makeU16Buffer(512);L[0]=1;for(x=1;x<512;x++){var A=x>>>1,O=1<<9-a.fls(x);if(L[A]===0||L[A]===O*2)L[x]=L[A]>>>1;else if(x>=256)L[x]=h.decodeBit();else{var M=h.decodeCulFreq(3);h.decodeUpdate(1,M,3),L[x]=M===2?O:M}}var _=0;for(x=0;x<256;x++)L[256+x]&&(y[_++]=x);L=null;var D=new r(h,_+1,l,c);d&&(D=new n(h,_+1,!0));var P=1;for(x=0;x<S;){N=D.decode();if(N===0){for(T=0;T<P;T++)E[x++]=0;P*=2}else if(N===1){for(T=0;T<P;T++)E[x++]=0,E[x++]=0;P*=2}else P=1,E[x++]=N-1}for(x=0;x<S;x++){T=E[x],E[x]=N=y[T];for(;T>0;T--)y[T]=y[T-1];y[0]=N}t.unbwtransform(v,m,g,S,k),u.write(m,0,S)}h.decodeFinish()}),BWTC}),n("lib/CRC32",["./Util"],function(e){var t=e.arraycopy(e.makeU32Buffer(256),[0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),n=function(){var e=4294967295;this.getCRC=function(){return~e>>>0},this.updateCRC=function(n){e=e<<8^t[(e>>>24^n)&255]},this.updateCRCRun=function(n,r){while(r-->0)e=e<<8^t[(e>>>24^n)&255]}};return n}),n("lib/HuffmanAllocator",["./freeze","./Util"],function(e,t){var n=function(e,t,n){var r=e.length,i=t,s=e.length-2;while(t>=n&&e[t]%r>i)s=t,t-=i-t+1;t=Math.max(n-1,t);while(s>t+1){var o=t+s>>1;e[o]%r>i?s=o:t=o}return s},r=function(e){var t=e.length;e[0]+=e[1];var n,r,i,s;for(n=0,r=1,i=2;r<t-1;r++)i>=t||e[n]<e[i]?(s=e[n],e[n++]=r):s=e[i++],i>=t||n<r&&e[n]<e[i]?(s+=e[n],e[n++]=r+t):s+=e[i++],e[r]=s},i=function(e,t){var r=e.length-2,i;for(i=1;i<t-1&&r>1;i++)r=n(e,r-1,0);return r},s=function(e){var t=e.length-2,r=e.length-1,i,s,o,u;for(i=1,s=2;s>0;i++){o=t,t=n(e,o-1,0);for(u=s-(o-t);u>0;u--)e[r--]=i;s=o-t<<1}},o=function(e,t,r){var i=e.length-2,s=e.length-1,o=r==1?2:1,u=r==1?t-2:t,a,f,l,c;for(a=o<<1;a>0;o++){f=i,i=i<=t?i:n(e,f-1,t),l=0,o>=r?l=Math.min(u,1<<o-r):o==r-1&&(l=1,e[i]==f&&i++);for(c=a-(f-i+l);c>0;c--)e[s--]=o;u-=l,a=f-i+l<<1}},u=function(e,n){switch(e.length){case 2:e[1]=1;case 1:e[0]=1;return}r(e);var u=i(e,n);if(e[0]%e.length>=u)s(e);else{var a=n-t.fls(u-1);o(e,u,a)}};return e({allocateHuffmanCodeLengths:u})}),n("lib/Bzip2",["./freeze","./BitStream","./BWT","./CRC32","./HuffmanAllocator","./Stream","./Util"],function(e,t,n,r,i,s,o){var u=20,a=258,f=0,l=1,c=2,h=6,p=50,d=54156738319193,v=25779555029136,m=s.EOF,g=function(e,t){var n=e[t],r;for(r=t;r>0;r--)e[r]=e[r-1];return e[0]=n,n},y={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},b={};b[y.LAST_BLOCK]="Bad file checksum",b[y.NOT_BZIP_DATA]="Not bzip data",b[y.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",b[y.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",b[y.DATA_ERROR]="Data error",b[y.OUT_OF_MEMORY]="Out of memory",b[y.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var w=function(e,t){var n=b[e]||"unknown error";t&&(n+=": "+t);var r=new TypeError(n);throw r.errorCode=e,r},E=function(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)};E.prototype._init_block=function(){var e=this._get_next_block();return e?(this.blockCRC=new r,!0):(this.writeCount=-1,!1)},E.prototype._start_bunzip=function(e,n){var r=o.makeU8Buffer(4);(e.read(r,0,4)!==4||String.fromCharCode(r[0],r[1],r[2])!=="BZh")&&w(y.NOT_BZIP_DATA,"bad magic");var i=r[3]-48;(i<1||i>9)&&w(y.NOT_BZIP_DATA,"level out of range"),this.reader=new t(e),this.dbufSize=1e5*i,this.nextoutput=0,this.outputStream=n,this.streamCRC=0},E.prototype._get_next_block=function(){var e,t,n,r=this.reader,i=r.readBits(48);if(i===v)return!1;i!==d&&w(y.NOT_BZIP_DATA),this.targetBlockCRC=r.readBits(32),this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,r.readBits(1)&&w(y.OBSOLETE_INPUT);var s=r.readBits(24);s>this.dbufSize&&w(y.DATA_ERROR,"initial position out of bounds");var m=r.readBits(16),b=o.makeU8Buffer(256),E=0;for(e=0;e<16;e++)if(m&1<<15-e){var S=e*16;n=r.readBits(16);for(t=0;t<16;t++)n&1<<15-t&&(b[E++]=S+t)}var x=r.readBits(3);(x<c||x>h)&&w(y.DATA_ERROR);var T=r.readBits(15);T===0&&w(y.DATA_ERROR);var N=o.makeU8Buffer(256);for(e=0;e<x;e++)N[e]=e;var C=o.makeU8Buffer(T);for(e=0;e<T;e++){for(t=0;r.readBits(1);t++)t>=x&&w(y.DATA_ERROR);C[e]=g(N,t)}var k=E+2,L=[],A;for(t=0;t<x;t++){var O=o.makeU8Buffer(k),M=o.makeU8Buffer(u+1);m=r.readBits(5);for(e=0;e<k;e++){for(;;){(m<1||m>u)&&w(y.DATA_ERROR);if(!r.readBits(1))break;r.readBits(1)?m--:m++}O[e]=m}var _,D;_=D=O[0];for(e=1;e<k;e++)O[e]>D?D=O[e]:O[e]<_&&(_=O[e]);A={},L.push(A),A.permute=o.makeU16Buffer(a),A.limit=o.makeU32Buffer(u+2),A.base=o.makeU32Buffer(u+1),A.minLen=_,A.maxLen=D;var P=0;for(e=_;e<=D;e++){M[e]=A.limit[e]=0;for(m=0;m<k;m++)O[m]===e&&(A.permute[P++]=m)}for(e=0;e<k;e++)M[O[e]]++;P=m=0;for(e=_;e<D;e++)P+=M[e],A.limit[e]=P-1,P<<=1,m+=M[e],A.base[e+1]=P-m;A.limit[D+1]=Number.MAX_VALUE,A.limit[D]=P+M[D]-1,A.base[_]=0}var H=o.makeU32Buffer(256);for(e=0;e<256;e++)N[e]=e;var B=0,j=0,F=0,I,q=this.dbuf=o.makeU32Buffer(this.dbufSize);k=0;for(;;){k--||(k=p-1,F>=T&&w(y.DATA_ERROR),A=L[C[F++]]),e=A.minLen,t=r.readBits(e);for(;;e++){e>A.maxLen&&w(y.DATA_ERROR);if(t<=A.limit[e])break;t=t<<1|r.readBits(1)}t-=A.base[e],(t<0||t>=a)&&w(y.DATA_ERROR);var R=A.permute[t];if(R===f||R===l){B||(B=1,m=0),R===f?m+=B:m+=2*B,B<<=1;continue}if(B){B=0,j+m>=this.dbufSize&&w(y.DATA_ERROR),I=b[N[0]],H[I]+=m;while(m--)q[j++]=I}if(R>E)break;j>=this.dbufSize&&w(y.DATA_ERROR),e=R-1,I=g(N,e),I=b[I],H[I]++,q[j++]=I}(s<0||s>=j)&&w(y.DATA_ERROR),t=0;for(e=0;e<256;e++)n=t+H[e],H[e]=t,t=n;for(e=0;e<j;e++)I=q[e]&255,q[H[I]]|=e<<8,H[I]++;var U=0,z=0,W=0;return j&&(U=q[s],z=U&255,U>>=8,W=-1),this.writePos=U,this.writeCurrent=z,this.writeCount=j,this.writeRun=W,!0},E.prototype._read_bunzip=function(e,t){var n,r,i;if(this.writeCount<0)return 0;var s=0,o=this.dbuf,u=this.writePos,a=this.writeCurrent,f=this.writeCount,l=this.outputsize,c=this.writeRun;while(f){f--,r=a,u=o[u],a=u&255,u>>=8,c++===3?(n=a,i=r,a=-1):(n=1,i=a),this.blockCRC.updateCRCRun(i,n);while(n--)this.outputStream.writeByte(i),this.nextoutput++;a!=r&&(c=0)}return this.writeCount=f,this.blockCRC.getCRC()!==this.targetBlockCRC&&w(y.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput},E.Err=y,E.decode=function(e,t,n){var r=o.coerceInputStream(e),i=o.coerceOutputStream(t,t),s=i.stream,u=new E(r,s);for(;;){if("eof"in r&&r.eof())break;if(u._init_block())u._read_bunzip();else{var a=u.reader.readBits(32);a!==u.streamCRC&&w(y.DATA_ERROR,"Bad stream CRC (got "+u.streamCRC.toString(16)+" expected "+a.toString(16)+")");if(!(n&&"eof"in r&&!r.eof()))break;u._start_bunzip(r,s)}}return i.retval},E.decodeBlock=function(e,t,n){var i=o.coerceInputStream(e),s=o.coerceOutputStream(n,n),u=s.stream,a=new E(i,u);a.reader.seekBit(t);var f=a._get_next_block();return f&&(a.blockCRC=new r,a.writeCopies=0,a._read_bunzip()),s.retval},E.table=function(e,t,n){var r=new s;r.delegate=o.coerceInputStream(e),r.pos=0,r.readByte=function(){return this.pos++,this.delegate.readByte()},r.tell=function(){return this.pos},r.delegate.eof&&(r.eof=r.delegate.eof.bind(r.delegate));var i=new s;i.pos=0,i.writeByte=function(){this.pos++};var u=new E(r,i),a=u.dbufSize;for(;;){if("eof"in r&&r.eof())break;var f=u.reader.tellBit();if(u._init_block()){var l=i.pos;u._read_bunzip(),t(f,i.pos-l)}else{var c=u.reader.readBits(32);if(!(n&&"eof"in r&&!r.eof()))break;u._start_bunzip(r,i),console.assert(u.dbufSize===a,"shouldn't change block size within multistream file")}}};var S=function(e,t){var n,r=[];for(n=0;n<t;n++)r[n]=e[n]<<9|n;r.sort(function(e,t){return e-t});var s=r.map(function(e){return e>>>9});i.allocateHuffmanCodeLengths(s,u),this.codeLengths=o.makeU8Buffer(t);for(n=0;n<t;n++){var a=r[n]&511;this.codeLengths[a]=s[n]}};S.prototype.computeCanonical=function(){var e=this.codeLengths.length,t,n=[];for(t=0;t<e;t++)n[t]=this.codeLengths[t]<<9|t;n.sort(function(e,t){return e-t}),this.code=o.makeU32Buffer(e);var r=0,i=0;for(t=0;t<e;t++){var s=n[t]>>>9,u=n[t]&511;console.assert(i<=s),r<<=s-i,this.code[u]=r++,i=s}},S.prototype.cost=function(e,t,n){var r,i=0;for(r=0;r<n;r++)i+=this.codeLengths[e[t+r]];return i},S.prototype.emit=function(e){var t,n=this.codeLengths[0];e.writeBits(5,n);for(t=0;t<this.codeLengths.length;t++){var r=this.codeLengths[t],i,s;console.assert(r>0&&r<=u),n<r?(i=2,s=r-n):(i=3,s=n-r);while(s-->0)e.writeBits(2,i);e.writeBit(0),n=r}},S.prototype.encode=function(e,t){e.writeBits(this.codeLengths[t],this.code[t])};var x=function(e,t,n,r){var i=0,s=-1,o=0;while(i<n){if(o===4){t[i++]=0;if(i>=n)break}var u=e.readByte();if(u===m)break;r.updateCRC(u);if(u!==s)s=u,o=1;else{o++;if(o>4){if(o<256){t[i-1]++;continue}o=1}}t[i++]=u}return i},T=function(e,t,n){var r,i,s;for(r=0,s=0;r<n.length;r+=p){var o=Math.min(p,n.length-r),u=0,a=t[0].cost(n,r,o);for(i=1;i<t.length;i++){var f=t[i].cost(n,r,o);f<a&&(u=i,a=f)}e[s++]=u}},N=function(e,t,n,r,i){var s,o,u,a=[];while(e.length<t){T(r,e,n);for(s=0;s<e.length;s++)a[s]=0;for(s=0;s<r.length;s++)a[r[s]]++;var f=a.indexOf(Math.max.apply(Math,a)),l=[];for(s=0,o=0;s<r.length;s++){if(r[s]!==f)continue;var c=s*p,h=Math.min(c+p,n.length);l.push({index:s,cost:e[f].cost(n,c,h-c)})}l.sort(function(e,t){return e.cost-t.cost});for(s=l.length>>>1;s<l.length;s++)r[l[s].index]=e.length;e.push(null);var d=[],v;for(s=0;s<e.length;s++){v=d[s]=[];for(o=0;o<i;o++)v[o]=0}for(s=0,o=0;s<n.length;){v=d[r[o++]];for(u=0;u<p&&s<n.length;u++)v[n[s++]]++}for(s=0;s<e.length;s++)e[s]=new S(d[s],i)}},C=function(e,t,r){var i,s,u,a,f=o.makeU8Buffer(t),l=n.bwtransform2(e,f,t,256);r.writeBit(0),r.writeBits(24,l);var d=[],v=[];for(s=0;s<t;s++)i=e[s],d[i]=!0,v[i>>>4]=!0;for(s=0;s<16;s++)r.writeBit(!!v[s]);for(s=0;s<16;s++)if(v[s])for(u=0;u<16;u++)r.writeBit(!!d[s<<4|u]);var m=0;for(s=0;s<256;s++)d[s]&&m++;var y=o.makeU16Buffer(t+1),b=m+1,w=[];for(s=0;s<=b;s++)w[s]=0;var E=o.makeU8Buffer(m);for(s=0,u=0;s<256;s++)d[s]&&(E[u++]=s);d=null,v=null;var x=0,C=0,k=function(e){y[x++]=e,w[e]++},L=function(){while(C!==0)C&1?(k(0),C-=1):(k(1),C-=2),C>>>=1};for(s=0;s<f.length;s++){i=f[s];for(u=0;u<m;u++)if(E[u]===i)break;console.assert(u!==m),g(E,u),u===0?C++:(L(),k(u+1),C=0)}L(),k(b),y=y.subarray(0,x);var A=[],O;x>=2400?O=6:x>=1200?O=5:x>=600?O=4:x>=200?O=3:O=2,A.push(new S(w,b+1));for(s=0;s<=b;s++)w[s]=1;A.push(new S(w,b+1)),w=null;var M=o.makeU8Buffer(Math.ceil(x/p));N(A,O,y,M,b+1),T(M,A,y),console.assert(A.length>=c&&A.length<=h),r.writeBits(3,A.length),r.writeBits(15,M.length);for(s=0;s<A.length;s++)E[s]=s;for(s=0;s<M.length;s++){var _=M[s];for(u=0;u<A.length;u++)if(E[u]===_)break;console.assert(u<A.length),g(E,u);for(;u>0;u--)r.writeBit(1);r.writeBit(0)}for(s=0;s<A.length;s++)A[s].emit(r),A[s].computeCanonical();for(s=0,a=0;s<x;){var D=A[M[a++]];for(u=0;u<p&&s<x;u++)D.encode(r,y[s++])}},k=Object.create(null);return k.compressFile=function(e,n,i){e=o.coerceInputStream(e);var s=o.coerceOutputStream(n,n);n=new t(s.stream);var u=9;typeof i=="number"&&(u=i);if(u<1||u>9)throw new Error("Invalid block size multiplier");var a=u*1e5;a-=19,n.writeByte("B".charCodeAt(0)),n.writeByte("Z".charCodeAt(0)),n.writeByte("h".charCodeAt(0)),n.writeByte("0".charCodeAt(0)+u);var f=o.makeU8Buffer(a),l=0,c;do{var h=new r;c=x(e,f,a,h),c>0&&(l=((l<<1|l>>>31)^h.getCRC())>>>0,n.writeBits(48,d),n.writeBits(32,h.getCRC()),C(f,c,n))}while(c===a);return n.writeBits(48,v),n.writeBits(32,l),n.flush(),s.retval},k.decompressFile=E.decode,k.decompressBlock=E.decodeBlock,k.table=E.table,k}),n("lib/Dmc",["./MTFModel","./RangeCoder","./Stream","./Util"],function(e,t,n,r){var i=65535,s=8,o=128,u=65280,a=256,f=!1,l=!1,c=Object.create(null);c.MAGIC="dmc!";var h=function(t,n,i){this.out=[],this.model=i?i.clone():new e(t,n,u,a),this.count=r.makeU16Buffer(n),this.sum=0};h.prototype.clone=function(e,t){var n,r=new h(e,t,f?this.model:null);for(n=0;n<t;n++)r.out[n]=this.out[n];return r};var p=function(e,t,n,r){var i,u;this.coder=e,this.size=t,this.MIN_CNT1=n||s,this.MIN_CNT2=r||o,this.nodes=[];for(i=0;i<t;i++)this.nodes[i]=new h(e,t);for(i=0;i<t;i++)for(u=0;u<t;u++)this.nodes[i].out[u]=this.nodes[u];this.current=this.nodes[0]};return p.prototype.maybeSplit=function(e,t,n){var r=e.count[t],i=n.sum,s;if(r<=this.MIN_CNT1||i-r<=this.MIN_CNT2)return n;var o=n.clone(this.coder,this.size);this.nodes.push(o),e.out[t]=o,o.sum=n.sum=0;for(s=0;s<this.size;s++)o.count[s]=n.count[s]*r/i,o.sum+=o.count[s],n.count[s]-=o.count[s],n.sum+=n.count[s];return o},p.prototype.encode=function(e){var t=this.current;t.model.encode(e);var n=t.out[e];t.count[e]!==i&&(t.count[e]++,t.sum++),this.current=this.maybeSplit(t,e,n)},p.prototype.decode=function(){var e=this.current,t=e.model.decode(),n=e.out[t];return e.count[t]!==i&&(e.count[t]++,e.sum++),this.current=this.maybeSplit(e,t,n),t},c.compressFile=r.compressFileHelper(c.MAGIC,function(e,i,u,a){a=a||{};var f=+a.m||s,c=+a.n||o;r.writeUnsignedNumber(i,f),r.writeUnsignedNumber(i,c);var h=new t(i);h.encodeStart(202,0);var d=new p(h,u<0?257:256,f,c),v=0;while(v!==u){var m=e.readByte();if(m===n.EOF){d.encode(256);break}d.encode(m),v++}var g=h.encodeFinish();l&&console.log("M1",d.MIN_CNT1,"M2",d.MIN_CNT2,"states",d.nodes.length,"size",g)}),c.decompressFile=r.decompressFileHelper(c.MAGIC,function(e,n,i){var s=r.readUnsignedNumber(e),o=r.readUnsignedNumber(e),u=new t(e);u.decodeStart();var a=new p(u,i<0?257:256,s,o),f=0;while(f!==i){var l=a.decode();if(l===256)break;n.writeByte(l),f++}u.decodeFinish()}),c}),n("lib/Lzjb",["./Stream","./Util"],function(e,t){var n=Object.create(null);n.MAGIC="lzjb";var r=8,i=6,s=3,o=(1<<i)+(s-1),u=(1<<16-i)-1,a=1024,f=e.EOF,l=!0;return n.compressFile=t.compressFileHelper(n.MAGIC,function(e,n,c,h){var p,d=[],v,m=0,g=0,y,b,w,E,S,x,T,N,C,k,L=a,A=1;typeof h=="number"&&(L*=2,h=Math.max(1,Math.min(9,h))-1,A=1<<Math.floor(h/2),h&1&&(A=Math.round(A*1.5)),h>=2&&h<=4&&A++),T=t.makeU16Buffer(L*A);var O=t.makeU8Buffer(u+1),M=0,_=function(e){return O[M++]=e,M>=O.length&&(M=0),e},D=t.makeU8Buffer(17),P=0,H=function(){var e;for(e=0;e<P;e++)n.writeByte(D[e]);P=0},B=[],j=function(){return B.length?B.pop():e.readByte()},F=function(e){B.push(e)},I=1<<r-1,q=[];for(;;){var R=j();if(R===f)break;(I<<=1)==1<<r&&(H(),I=1,D[0]=0,P=1);var U=j();if(U===f){D[P++]=_(R);break}var z=j();if(z===f){D[P++]=_(R),F(U);continue}S=(R<<16)+(U<<8)+z,S^=S>>9,S+=S>>5,S^=R,x=(S&L-1)*A,q.length=0;for(C=0;C<A;C++){E=M-T[x+C]&u,y=O.length+M-E;var W=O[y&u],X=O[y+1&u],V=O[y+2&u];l&&E===0?W=R^1:E==1?(X=R,V=U):E==2&&(V=R),R===W&&U===X&&z===V&&q.push(E)}for(C=A-1;C>0;C--)T[x+C]=T[x+C-1];T[x]=M;if(q.length===0)D[P++]=_(R),F(z),F(U);else{D[0]|=I,_(R),_(U),_(z);var $=j(),J=q[0],K=O.length+M;for(w=s;w<o;w++,K++){if($===f)break;for(C=0;C<q.length;){var Q=O[K-q[C]&u];$!==Q?(J=q[C],q.splice(C,1)):C++}if(q.length===0)break;_($),$=j()}q.length!==0&&(J=q[0]),F($),D[P++]=w-s<<r-i|J>>r,D[P++]=J&255}}H()}),n.decompressFile=t.decompressFileHelper(n.MAGIC,function(e,n,o){var a,l=[],c,h=0,p=0,d,v,m,g,y,b,w,E=t.makeU8Buffer(u+1),S=0,x=1<<r-1;while(o!==0){b=e.readByte();if(b===f)break;(x<<=1)==1<<r&&(x=1,v=b,b=e.readByte());if(v&x){m=(b>>r-i)+s,g=(b<<r|e.readByte())&u,d=S-g,d<0&&(d+=E.length),o>=0&&(o-=m);while(--m>=0)b=E[S++]=E[d++],n.writeByte(b),S>=E.length&&(S=0),d>=E.length&&(d=0)}else n.writeByte(b),E[S++]=b,S>=E.length&&(S=0),o>=0&&o--}}),n}),n("lib/LzjbR",["./Context1Model","./FenwickModel","./LogDistanceModel","./NoModel","./RangeCoder","./Stream","./Util"],function(e,t,n,r,i,s,o){var u=Object.create(null);u.MAGIC="lzjR";var a=8,f=6,l=3,c=(1<<f)+(l-1),h=(1<<16-f)-1,p=1024,d=32;return u.compressFile=o.compressFileHelper(u.MAGIC,function(u,a,f,v,m){var g,y=[],b,w=0,E=0,S,x,T,N,C,k,L,A,O,M=p,_=1;typeof v=="number"&&(M*=2,v=Math.max(1,Math.min(9,v))-1,_=1<<Math.floor(v/2),v&1&&(_=Math.round(_*1.5)),v>=2&&v<=4&&_++);var D=new i(a);D.encodeStart(m,1),L=o.makeU16Buffer(M*_);var P=o.makeU8Buffer(h+1),H=0,B=function(e){return P[H++]=e,H>=P.length&&(H=0),e},j=[],F=function(){return j.length?j.pop():u.readByte()},I=function(e){j.push(e)},q=[],R=256,U=257,z=r.factory(D),W=t.factory(D,65280,256),X=new e(W,256,(f<0?U:R)+1),V=function(e){return e<=d?W(e):z(e)},$=new n(c-l+1,0,W,V),J=new n(h+1,1,W,V),K=32,Q=0;for(;;){var G=H,Y=F();if(Y===s.EOF)break;var Z=F();if(Z===s.EOF){X.encode(B(Y),K);break}var et=F();if(et===s.EOF){X.encode(B(Y),K),I(Z),K=Y;continue}C=(Y<<16)+(Z<<8)+et,C^=C>>9,C+=C>>5,C^=Y,k=(C&M-1)*_,q.length=0;for(O=0;O<_;O++){N=H-L[k+O]&h,S=P.length+H-N;var tt=P[S&h],nt=P[S+1&h],rt=P[S+2&h];N==1?(nt=Y,rt=Z):N==2&&(rt=Y),Y===tt&&Z===nt&&et===rt&&q.push(N)}for(O=_-1;O>0;O--)L[k+O]=L[k+O-1];L[k]=H;if(q.length===0)X.encode(B(Y),K),I(et),I(Z),K=Y;else{X.encode(R,K),B(Y),B(Z),B(et),K=et;var it=F(),st=q[0],ot=P.length+H;for(T=l;T<c;T++,ot++){if(it===s.EOF)break;for(O=0;O<q.length;){var ut=P[ot-q[O]&h];it!==ut?(st=q[O],q.splice(O,1)):O++}if(q.length===0)break;B(it),K=it,it=F()}q.length!==0&&(st=q[0]),I(it),$.encode(T-l),N=G-st&h,N===Q?J.encode(-1):(J.encode(N),Q=N)}}f<0&&X.encode(U,K),D.encodeFinish()},!0),u.decompressFile=o.decompressFileHelper(u.MAGIC,function(s,u,a){var f,p=[],v,m=0,g=0,y,b,w,E,S,x,T=o.makeU8Buffer(h+1),N=0,C=new i(s);C.decodeStart(!0);var k=256,L=257,A=r.factory(C),O=t.factory(C,65280,256),M=new e(O,256,(a<0?L:k)+1),_=function(e){return e<=d?O(e):A(e)},D=new n(c-l+1,0,O,_),P=new n(h+1,1,O,_),H=32,B=0;while(a!==0){x=M.decode(H);if(x===L)break;if(x===k){w=D.decode()+l,y=P.decode(),y<0?y=B:B=y,a>=0&&(a-=w);while(--w>=0)x=H=T[N++]=T[y++],u.writeByte(x),N>=T.length&&(N=0),y>=T.length&&(y=0)}else u.writeByte(x),T[N++]=H=x,N>=T.length&&(N=0),a>=0&&a--}C.decodeFinish()}),u}),n("lib/Lzp3",["./BitStream","./Context1Model","./DefSumModel","./FenwickModel","./Huffman","./LogDistanceModel","./NoModel","./RangeCoder","./Stream","./Util"],function(e,t,n,r,i,s,o,u,a,f){var l=Object.create(null);l.MAGIC="lzp3";var c=!1,h=!1,p=256,d=65280,v=256,m=65536,g=4096,y=65536,b=4,w=20,E=1<<w,S=E-1,x=16,T=4294967295,N=16777215,C=65535,k=255,L=function(e){this.buffer=f.makeU8Buffer(Math.min(e+4,E)),this.pos=0,this.ctxt4=f.makeU32Buffer(m),this.ctxt3=f.makeU32Buffer(g),this.ctxt2=f.makeU32Buffer(y),this.put(99),this.put(83),this.put(97),this.put(32)};return L.prototype.put=function(e){return this.buffer[this.pos++]=e,this.pos>=E&&(this.pos=0),e},L.prototype.get=function(e){return this.buffer[e&E-1]},L.prototype.context=function(e,t){var n=0,r;e=e-t&E-1;for(r=0;r<t;r++)n=n<<8|this.buffer[e++],e>=E&&(e=0);return n},L.prototype.getIndex=function(e,t){var n=this.context(e,4),r=(n>>>15^n)&m-1,i=(n>>>11^n)&g-1,s=n&C,o=0,u;return t===0&&(o=this.ctxt4[r],o!==0&&n!==this.context(o-1,4)&&(o=0),o===0&&(o=this.ctxt3[i],o!==0&&(n&N)!==this.context(o-1,3)&&(o=0),o===0&&(o=this.ctxt2[s],o!==0&&(n&&C)!==this.context(o-1,2)&&(o=0)))),t&&t--,this.ctxt4[r]=this.ctxt3[i]=this.ctxt2[s]=(e|t<<w)+1,o},l.compressFile=f.compressFileHelper(l.MAGIC,function(f,l,m,g){var y=new L(m>=0?m:E),b,T,N;if(c){l.writeByte(128);var k=new e(l);N=k.flush.bind(k),b=i.factory(k,C),T=o.factory(k)}else{var A=new u(l);A.encodeStart(0,0),b=r.factory(A,d,v),h&&(b=n.factory(A,!1));var O=o.factory(A);T=function(e){return e>p?O(e):b(e)},N=function(){A.encodeFinish()}}var M=new t(b,256,m<0?257:256),_=[],D;for(D=0;D<x;D++)_[D]=new s(S+1,1,b,T);var P=0,H,B=0;while(P!==m){var j=f.readByte();H=y.pos;var F=y.getIndex(H,0);if(F!==0){F--;var I=(F>>>w)+1,q=0;while(y.get(F+q)===j&&q<S)q++,y.put(j),j=f.readByte();I===q?_[B&x-1].encode(-1):_[B&x-1].encode(q),y.getIndex(H,q),P+=q,B<<=1,q>0&&(B|=1)}var R=y.get(y.pos-1);if(j===a.EOF){m<0&&M.encode(256,R);break}M.encode(j,R),y.put(j),P++}N&&N()}),l.decompressFile=f.decompressFileHelper(l.MAGIC,function(a,f,l){var c=a.readByte(),m=!!(c&128),g=new L(l>=0?l:E),y,b,T;if(m){var N=new e(a);y=i.factory(N,C),b=o.factory(N)}else{var k=new u(a);k.decodeStart(!0),y=r.factory(k,d,v),h&&(y=n.factory(k,!0));var A=o.factory(k);b=function(e){return e>p?A(e):y(e)},T=function(){k.decodeFinish()}}var O=new t(y,256,l<0?257:256),M=[],_;for(_=0;_<x;_++)M[_]=new s(S+1,1,y,b);var D,P,H=0,B=0;while(H!==l){D=g.pos;var j=g.getIndex(D,0);if(j!==0){j--;var F=(j>>>w)+1,I=M[B&x-1].decode();I<0&&(I=F);for(_=0;_<I;_++)P=g.get(j+_),f.writeByte(g.put(P));g.getIndex(D,I),H+=I,B<<=1,I>0&&(B|=1)}if(H===l)break;var q=g.get(g.pos-1);P=O.decode(q);if(P===256)break;f.writeByte(g.put(P)),H++}T&&T()}),l}),n("lib/PPM",["./RangeCoder","./Util"],function(e,t){var n=5,r=18,i=1<<r,s=function(){this.buffer=t.makeU8Buffer(i),this.pos=0,this.firstPass=!0;for(var e=0;e<n;e++)this.put("cSaCsA".charCodeAt(e%6))};s.prototype.put=function(e){return this.buffer[this.pos++]=e,this.pos>=i&&(this.pos=0,this.firstPass=!1),e},s.prototype.get=function(e){return this.buffer[e&i-1]},s.prototype.context=function(e,t){var n=[],r;e=e-t&i-1;for(r=0;r<t;r++)n.push(this.buffer[e++]),e>=i&&(e=0);return String.fromCharCode.apply(String,n)};var o=256,u=65280,a=function(e,t){this.window=new s,this.contexts=Object.create(null);var r=function(){};r.prototype.encode=function(n,r){var i,s=0;for(i=0;i<n;i++)r[i]||s++;var o=t-r.total;e.encodeFreq(1,s,o)},r.prototype.decode=function(n){var r,i,s,o=t-n.total;i=s=e.decodeCulFreq(o);for(r=0;r<=i;r++)n[r]&&i++;return e.decodeUpdate(1,s,o),i},this.cm1coder=new r;var i=function(){this.sym=[t],this.prob=[0,o],this.refcount=0};i.prototype._rescale=function(){var e=this.sym.length,n,r,i=0,s=!0;for(n=0,r=0;n<e;n++){var o=this.sym[n],u=this.prob[n+1]-this.prob[n];u>>>=1,u>0&&(o===t&&(s=!1),this.sym[r]=o,this.prob[r++]=i,i+=u)}return this.prob[r]=i,e=this.sym.length=r,this.prob.length=e+1,s&&e<t&&(i=this._update(t,e,0,1)),i},i.prototype.update=function(e,t){var n=0;for(n=0;n<this.sym.length;n++)if(this.sym[n]===e)return this._update(e,n,this.prob[n+1]-this.prob[n],t);return this._update(e,n,0,t)},i.prototype._update=function(e,n,r,i){var s=this.sym.length,o,a,f;for(a=n;a<s-1;a++)this.sym[a]=this.sym[a+1],this.prob[a]=this.prob[a+1]-r;if(n<s)this.sym[a]=e,this.prob[a]=this.prob[a+1]-r,this.prob[s]=f=this.prob[s]+i;else{f=this.prob[s],this.sym[n]=e,this.prob[n]=f,f+=i,this.prob[++s]=f;if(this.sym.length>t)for(o=0;o<s;o++)t===this.sym[o]&&(this._update(t,o,this.prob[o+1]-this.prob[o],-1),this.sym.length--,this.prob.length--,f=this.prob[this.prob.length-1])}return f>=u&&(f=this._rescale()),f},i.prototype.encode=function(n,r){var i,s,u,a,f,l=this.sym.length,c=0,h=0,p=0,d;for(i=l-1;i>=0;i--){a=this.prob[i],u=this.prob[i+1]-a;if(n===this.sym[i]){for(s=i-1;s>=0&&c<r.total;s--)r[this.sym[s]]&&(c+=1,d=this.prob[s+1]-this.prob[s],h+=d,p+=d);return f=this.prob[l],a-=h,f-=p,e.encodeFreq(u,a,f),n===t?(this._update(n,i,u,o/2),!1):!0}r[this.sym[i]]&&(c+=1,p+=u)}this.encode(t,r),console.assert(this.sym[this.sym.length-1]===t);for(i=0;i<this.sym.length-1;i++)r[this.sym[i]]||(r[this.sym[i]]=!0,r.total++)},i.prototype.decode=function(n){var r=this.sym.length,i=this.prob[r],s=0,u=0,a=0,f,l;for(l=r-1;l>=0&&s<n.total;l--)n[this.sym[l]]&&(s+=1,a+=this.prob[l+1]-this.prob[l]);var c=e.decodeCulFreq(i-a)+a;u=a;for(l=r-1;l>=0;l--)if(n[this.sym[l]])f=this.prob[l+1]-this.prob[l],u-=f,c-=f;else if(this.prob[l]<=c)break;console.assert(l>=0);var h=this.sym[l],p=this.prob[l],d=this.prob[l+1]-p;e.decodeUpdate(d,p-u,i-a);if(h<t)return h;this._update(h,l,d,o/2),console.assert(this.sym[this.sym.length-1]===t);for(l=0;l<this.sym.length-1;l++)n[this.sym[l]]||(n[this.sym[l]]=!0,n.total++);return-1},this.newContext=function(e){return new i},this.newExclude=function(){var e=Object.create(null);return e.total=0,e},function(){var e,t;for(e=0;e<n;e++)for(t=0;t<=e;t++){var r=this.window.context(t+(n-1-e),t);this.contexts[r]||(this.contexts[r]=this.newContext()),this.contexts[r].refcount++}}.call(this)};return a.prototype.update=function(e,t,r){var i,s,u;for(s=0;s<=n;s++)u=t.slice(n-s),i=this.contexts[u],i||(i=this.contexts[u]=this.newContext()),s>=r&&i.update(e,o/2),i.refcount++;t=this.window.context(this.window.pos+n,n);var a=this.window.firstPass;for(s=n;s>=0&&!a;s--)u=t.slice(0,s),i=this.contexts[u],console.assert(i),--i.refcount<=0&&(console.assert(u!==""),delete this.contexts[u]);this.window.put(e)},a.prototype.decode=function(){var e=this.window.context(this.window.pos,n),t=this.newExclude(),r,i,s,o;for(i=n;i>=0;i--){s=e.slice(n-i),r=this.contexts[s];if(r){o=r.decode(t);if(o>=0)return this.update(o,e,i),o}}return o=this.cm1coder.decode(t),this.update(o,e,i),o},a.prototype.encode=function(e){var t=this.window.context(this.window.pos,n),r=this.newExclude(),i;for(i=n;i>=0;i--){var s=t.slice(n-i),o=this.contexts[s];if(o){var u=o.encode(e,r);if(u){this.update(e,t,i);return}}}this.cm1coder.encode(e,r),this.update(e,t,i);return},a.MAGIC="ppm2",a.compressFile=t.compressFileHelper(a.MAGIC,function(n,r,i,s,o){var u=new e(r);u.encodeStart(o,1);var f=new a(u,i<0?257:256);t.compressWithModel(n,i,f),u.encodeFinish()},!0),a.decompressFile=t.decompressFileHelper(a.MAGIC,function(n,r,i){var s=new e(n);s.decodeStart(!0);var o=new a(s,i<0?257:256);t.decompressWithModel(r,i,o),s.decodeFinish()}),a}),n("lib/Simple",["./RangeCoder","./Stream","./Util"],function(e,t,n){var r=1<<17,i=Object.create(null);return i.MAGIC="smpl",i.compressFile=n.compressFileHelper(i.MAGIC,function(i,s,o,u,a){var f=new e(s);f.encodeStart(a,1);var l=n.makeU8Buffer(r),c=[],h=0,p=!1,d=function(){var e=0;for(e=0;e<256;e++)c[e]=0;if(p){h=0;return}for(e=0;e<r;){var n=i.readByte();if(n===t.EOF){p=!0;break}l[e++]=n,c[n]++;if(c[n]===65535)break}h=e};for(;;){var v;d();if(p&&h===0)break;f.encodeBit(!0);for(v=0;v<256;v++)f.encodeShort(c[v]);c[256]=h;for(v=256;v;v--)c[v-1]=c[v]-c[v-1];for(v=0;v<h;v++){var m=l[v];f.encodeFreq(c[m+1]-c[m],c[m],c[256])}}f.encodeBit(!1),f.encodeFinish()},!0),i.decompressFile=n.decompressFileHelper(i.MAGIC,function(t,n,r){var i=new e(t);i.decodeStart(!0);while(i.decodeBit()){var s,o=[];for(s=0;s<256;s++)o[s]=i.decodeShort();var u=0;for(s=0;s<256;s++){var a=o[s];o[s]=u,u+=a}o[256]=u;for(s=0;s<u;s++){var f=i.decodeCulFreq(u),l;for(l=0;l<256;l++)if(o[l]<=f&&f<o[l+1])break;var c=l;i.decodeUpdate(o[l+1]-o[l],o[l],u),n.writeByte(l)}}i.decodeFinish()}),i}),n("compressjs",["./lib/freeze","./lib/BitStream","./lib/Stream","./lib/BWT","./lib/Context1Model","./lib/DefSumModel","./lib/FenwickModel","./lib/MTFModel","./lib/NoModel","./lib/Huffman","./lib/RangeCoder","./lib/BWTC","./lib/Bzip2","./lib/Dmc","./lib/Lzjb","./lib/LzjbR","./lib/Lzp3","./lib/PPM","./lib/Simple"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){return e({version:"0.0.1",BitStream:t,Stream:n,BWT:r,Context1Model:i,DefSumModel:s,FenwickModel:o,MTFModel:u,NoModel:a,Huffman:f,RangeCoder:l,BWTC:c,Bzip2:h,Dmc:p,Lzjb:d,LzjbR:v,Lzp3:m,PPM:g,Simple:y})}),t("compressjs")});